<!-- <div class="row"> -->
<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px',fullScreenBackdrop:true }"></ngx-loading>
<div class="content" style="width: 35%; padding-right: 20px;">
    <app-document-upload (uploadDocument)="afterUploadDocs($event)"></app-document-upload>
    <br>
    <div>
        <span *ngFor="let docs of documents; let i=index">
            <div style="padding: 5px; display: block; text-decoration:underline;">
                <a *ngIf="!docs.isDeleted" href="javascript:;" (click)="getSignedUrl(docs)">{{docs.fileName}}</a>
                <button *ngIf="!docs.isDeleted" (click)="deleteFile(docs.filePath)" style="float: right;"><i
                        class="fa fa-trash" aria-hidden="true"></i></button>

                <a *ngIf="docs.isDeleted">{{docs.fileName}}</a> &nbsp;&nbsp;
                <button *ngIf="docs.isDeleted" (click)="deletedFileInfo(docs.cloudFileId)" style="float: right;"
                    title="Deleted file information"><i class="fa fa-info-circle" aria-hidden="true"></i></button>
            </div>

        </span>
        <div *ngIf="deletedFileData.length > 0" class="userInfo">
            <button style="float: right; margin-bottom: 3px;" (click)="closeDialog()"><i class="fa fa-times-circle"
                    aria-hidden="true"></i></button>
            <table>
                <tr>
                    <th><b>Doc Deleted By</b></th>
                    <th><b>Action</b></th>
                    <th><b>Date</b></th>
                </tr>
                <tr *ngFor="let data of deletedFileData">
                    <td>{{data.actionBy === ITR_JSON.userId ? 'User' : 'Tax Buddy'}}</td>
                    <td>{{data.action}}</td>
                    <td>{{data.date | date}}</td>
                </tr>
            </table>
        </div>
    </div>
    <app-document-viewer [docUrl]="docUrl" [viewer]="viewer"></app-document-viewer>
</div>

<div class="content" style="width: 65%;">
    <div class="card__title" style="padding:10px; font-size: 20px;">Customer Profile</div>
    <!-- <app-update-status [userId]="ITR_JSON.userId"></app-update-status> -->
    <hr>
    <form [formGroup]="customerProfileForm">
        <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Father Name</mat-label>
                    <input type="text" matInput placeholder="Father's name" name="mobile"
                        [formControl]="customerProfileForm.controls['fatherName']" class="input-field" maxlength="125"
                        capitalizeFirst required>
                    <mat-error *ngIf="customerProfileForm.controls['fatherName'].hasError('pattern')">
                        Enter character only</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Residential status</mat-label>
                    <mat-select placeholder="Residential status" name="residentialStatus"
                        (selectionChange)="onSelectRecidencial(customerProfileForm.controls['residentialStatus'].value)"
                        [formControl]="customerProfileForm.controls['residentialStatus']" required>
                        <mat-option *ngFor="let res of residentialStatus" [value]="res.value">
                            {{ res.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Employer Category</mat-label>
                    <mat-select placeholder="Employer Category" name="employerCategory"
                        formControlName="employerCategory">
                        <mat-option *ngFor="let emp of employersDropdown" [value]="emp.value">
                            {{ emp.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Select Gender</mat-label>
                    <mat-select placeholder="Select Gender" name="gender" formControlName="gender">
                        <mat-option *ngFor="let gender of genderMaster" [value]="gender.value">
                            {{ gender.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <!--  <div formGroupName="seventhProviso139">
            <div class="card__row">
                <div class="card__col-xs-12 card__col-sm-8">
                    Have you deposited more than 1 crore in your current A/c ( if Yes) then Enter the
                    Amount
                </div>
                <div class="card__col-xs-12 card__col-sm-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input matInput placeholder="Amount" name="depAmtAggAmtExcd1CrPrYrFlg"
                            formControlName="depAmtAggAmtExcd1CrPrYrFlg" class="input-field" maxlength="14" digitsOnly>
                    </mat-form-field>
                </div>
            </div>
            <div class="card__row">
                <div class="card__col-xs-12 card__col-sm-8">
                    Your foreign travel expenses is more than Rs. 2 Lakhs (If yes, then enter amount of
                    expenditure)
                </div>
                <div class="card__col-xs-12 card__col-sm-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input matInput placeholder="Amount" name="incrExpAggAmt2LkTrvFrgnCntryFlg"
                            formControlName="incrExpAggAmt2LkTrvFrgnCntryFlg" class="input-field" maxlength="14"
                            digitsOnly>
                    </mat-form-field>
                </div>
            </div>
            <div class="card__row">
                <div class="card__col-xs-12 card__col-sm-8">
                    Have your electricity bill exceeded 1 Lakh? (If yes, then enter amount)
                </div>
                <div class="card__col-xs-12 card__col-sm-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input matInput placeholder="Amount" name="incrExpAggAmt1LkElctrctyPrYrFlg"
                            formControlName="incrExpAggAmt1LkElctrctyPrYrFlg" class="input-field" maxlength="14"
                            digitsOnly>
                    </mat-form-field>
                </div>

            </div>

        </div> -->
        <hr>
        <div class="card__title" style="padding:10px; font-size: 20px;">Address Details</div>
        <div formGroupName="address">
            <div class="card__row">
                <div class="card__col-xs-12 card__col-sm-6">
                    <mat-form-field appearance="outline">
                        <mat-label>Flat/Door/Block No.</mat-label>
                        <input type="text" trim matInput placeholder="Flat/Door/Block No." name="flatNo"
                            formControlName="flatNo" class="input-field" maxlength="50" required>
                    </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                    <mat-form-field appearance="outline">
                        <mat-label>Premises name</mat-label>
                        <input type="text" trim matInput placeholder="Premises name" name="premisesName"
                            formControlName="premisesName" class="input-field" maxlength="50">
                    </mat-form-field>
                </div>
            </div>
            <div class="card__row">
                <div class="card__col-xs-12 card__col-sm-6">
                    <mat-form-field appearance="outline">
                        <mat-label>Area/ Locality</mat-label>
                        <input type="text" trim matInput placeholder="Area/ Locality" name="area" formControlName="area"
                            class="input-field" maxlength="50" required>
                    </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                    <mat-form-field appearance="outline">
                        <mat-label>PIN Code</mat-label>
                        <input type="text" matInput placeholder="PIN code" name="pinCode" formControlName="pinCode"
                            class="input-field" maxlength="6" minlength="6" trim digitsOnly required
                            (blur)="getCityData()">
                        <mat-error
                            *ngIf="customerProfileForm.controls['address'].controls['pinCode'].hasError('pattern') || customerProfileForm.controls['address'].controls['pinCode'].hasError('minLength') || customerProfileForm.controls['address'].controls['pinCode'].hasError('maxLength')">
                            Enter
                            6 digit PIN code.</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="card__row">
                <div class="card__col-xs-12 card__col-sm-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Select country</mat-label>
                        <mat-select placeholder="Select country" name="country" formControlName="country"
                            (selectionChange)="changeCountry(customerProfileForm.controls['address'].controls['country'].value)"
                            required>
                            <mat-option *ngFor="let country of countryDropdown" [value]="country.countryCode">
                                {{ country.countryName | titlecase}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Select state</mat-label>
                        <mat-select placeholder="Select state" name="state" formControlName="state" required>
                            <mat-option *ngFor="let state of stateDropdown" [value]="state.stateCode">
                                {{ state.stateName | titlecase}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-4">
                    <mat-form-field appearance="outline">
                        <mat-label>City</mat-label>
                        <input type="text" trim matInput placeholder="City/Taluka/District" name="city"
                            formControlName="city" class="input-field" maxlength="50" required>
                        <mat-error *ngIf="customerProfileForm.controls['address'].controls['city'].hasError('pattern')">
                            Enter valid
                            city name.</mat-error>
                    </mat-form-field>
                </div>
            </div>
        </div>
        <hr>
        <div class="card__title" style="padding:10px; font-size: 20px;">Bank Details</div>
        <table class="table table-bordered" style="width: 100%;">
            <thead style="background:#eaeaea">
                <tr class="table-head" style="border-left: 1px solid #e0e0e0;border-right: 2px solid #f2f0f0;">
                    <th class="text-center">No</th>
                    <th class="text-center">IFSC Code</th>
                    <th class="text-center">Name of Bank</th>
                    <th class="text-center">Account Number</th>
                    <th class="text-center">Refund Acc.</th>
                    <th class="action-th ">
                        <button mat-icon-button color="warn" class="table-add-remove-button text-left"
                            (click)="addMoreBanks(this.customerProfileForm)">
                            <i class="fa fa-plus-square" aria-hidden="true"></i> Add
                        </button>
                    </th>
                </tr>
            </thead>
            <tbody formArrayName="bankDetails">
                <tr *ngFor="let bank of getBankDetailsArray.controls;let i=index" [formGroupName]="i">
                    <td> {{i+1}}</td>
                    <td>
                        <mat-form-field class="input-field-width" style="width: 90% !important;">
                            <input type="text" trim upperCase matInput formControlName="ifsCode" placeholder=""
                                name="ifsCode[i]" class="input-field" maxlength="11" required
                                (blur)="getBankListByIfsc(customerProfileForm.controls['bankDetails'].controls[i].controls['ifsCode'],i)">
                            <mat-error
                                *ngIf="customerProfileForm.controls['bankDetails'].controls[i].controls['ifsCode'].hasError('pattern')">
                                Enter valid IFSC Code.</mat-error>
                        </mat-form-field>
                    </td>

                    <td>
                        <mat-form-field class="input-field-width" style="width: 90% !important;">
                            <input type="text" trim matInput formControlName="name" placeholder="" name="name[i]"
                                class="input-field" maxlength="125" required>
                        </mat-form-field>
                    </td>
                    <td>
                        <mat-form-field class="input-field-width" style="width: 90% !important;">
                            <input type="text" trim matInput formControlName="accountNumber" placeholder=""
                                name="accountNumber[i]" class="input-field" maxlength="20" minlength="3" digitsOnly
                                required>
                            <mat-error
                                *ngIf="customerProfileForm.controls['bankDetails'].controls[i].controls['accountNumber'].hasError('pattern') || customerProfileForm.controls['bankDetails'].controls[i].controls['accountNumber'].hasError('minlength')">
                                Account number should be between 3-20 digit</mat-error>
                        </mat-form-field>
                    </td>
                    <td style="padding-left: 15px;">
                        <mat-checkbox color="primary" name="hasRefund[i]" formControlName="hasRefund">
                        </mat-checkbox>
                    </td>

                    <td style="white-space: nowrap;padding: 0%;border:none;justify-content: center;">
                        <button mat-icon-button color="warn" class="table-add-remove-button text-left"
                            (click)="deleteBank(i,this.customerProfileForm)">
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <hr>
        <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-8" style="padding-top: 10px;">
                Are you opting for New Tax Regime?
            </div>
            <div class="card__col-xs-12 card__col-sm-4">
                <mat-form-field appearance="outline">
                    <mat-label>Select One</mat-label>
                    <mat-select name="regime" formControlName="regime" required>
                        <!-- formControlName="employerCategory" TODO -->
                        <mat-option value="NEW"> Yes </mat-option>
                        <mat-option value="OLD"> No </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <div class="footer__buttons clearfix" style="margin-top: 40px;">
            <button class="tbd-btn-secondary" (click)="previousRoute()"><i class="fa fa-arrow-left"
                    aria-hidden="true"></i>
                &nbsp;&nbsp;Back</button>
            <button class="tbd-btn" (click)="saveProfile('NEXT')">Save and Continue
            </button>
        </div>
    </form>
</div>
<!-- </div> -->