<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px',fullScreenBackdrop:true }"></ngx-loading>

<div class="content content_full">

  <div class="content__container">
    <ng-template [ngIf]="merchantData && merchantData.userId">
      <form [formGroup]="gstDetails">
        <div class="card">
          <div class="card__title">Basic information</div>

          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'User Name'" [type]="'text'" [name]="merchantName" [placeholder]="'User Name'"
              [value]="merchantData.name" [disabled]="true"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>User Name</mat-label>
                <input placeholder="User Name" [(ngModel)]="merchantData.name" [ngModelOptions]="{standalone: true}"
                  [disabled]="true" matInput>
              </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'GST Portal User Name'" [type]="'text'" [name]="'letn'"
              [placeholder]="'GST Portal User Name'" [value]="merchantData.gstDetails.gstPortalUserName"
              (sendValue)="merchantData.gstDetails.gstPortalUserName = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>GST Portal User Name</mat-label>
                <input placeholder="GST Portal User Name" formControlName="gstPortalUserName" maxlength="50" matInput>
              </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'GST Portal Password'" [type]="'text'" [name]="'lap'" [placeholder]="'Password'"
                [value]="merchantData.gstDetails.gstPortalPassword"
                (sendValue)="merchantData.gstDetails.gstPortalPassword = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>GST Portal Password</mat-label>
                <input placeholder="Password" formControlName="gstPortalPassword" maxlength="50" matInput>
              </mat-form-field>
            </div>
          </div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'GSTIN Number'" [type]="'text'" [is_capital]="true"
                [name]="merchantData.gstDetails.gstn_number" [placeholder]="'GSTIN Number'"
                [value]="merchantData.gstDetails.gstinNumber" (sendValue)="onEnterGSTIN($event)" [max_length]="15">
              </app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>GSTIN Number</mat-label>
                <input placeholder="GSTIN Number" maxlength="15" type="text" formControlName="gstinNumber" required
                  (blur)="onEnterGSTIN($event)" matInput>
              </mat-form-field>
              <mat-error *ngIf="gstDetails['controls'].gstinNumber.hasError('pattern')">
                Please enter valid GSTN.
              </mat-error>
              <!-- (inputFocusOut)="onFoucusOutOfGSTINNumber()" -->
            </div>

            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'Trade Name'" [type]="'text'" [name]="merchantData.gstDetails.tradeName"
                [placeholder]="'Trade Name'" [value]="merchantData.gstDetails.tradeName"
                (sendValue)="merchantData.gstDetails.tradeName = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Trade Name</mat-label>
                <input placeholder="Trade Name" maxlength="50" formControlName="tradeName" required matInput>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'Legal Name'" [type]="'text'" [name]="merchantData.gstDetails.legalName"
                [placeholder]="'Legal Name'" [value]="merchantData.gstDetails.legalName"
                (sendValue)="merchantData.gstDetails.legalName = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Legal Name</mat-label>
                <input placeholder="Legal Name" maxlength="50" formControlName="legalName" matInput>
              </mat-form-field>
            </div>
          </div>

          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'Contact Number'" [type]="'text'" [name]="merchantData.mobileNumber"
                [placeholder]="'Contact Number'" [value]="merchantData.mobileNumber"
                (sendValue)="merchantData.mobileNumber = $event" [disabled]="true"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Contact Number</mat-label>
                <input placeholder="Contact Number" [(ngModel)]="merchantData.mobileNumber"
                  [ngModelOptions]="{standalone: true}" [disabled]="true" matInput>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'GSTIN Registered Mobile Number'" [type]="'text'"
                [name]="merchantData.gstDetails.gstinRegisteredMobileNumber"
                [placeholder]="'GSTN Registered Mobile Number'"
                [value]="merchantData.gstDetails.gstinRegisteredMobileNumber"
                (sendValue)="merchantData.gstDetails.gstinRegisteredMobileNumber = $event" [max_length]="15">
              </app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>GSTIN Registered Mobile Number</mat-label>
                <input placeholder="GSTIN Registered Mobile Number" formControlName="gstinRegisteredMobileNumber"
                  matInput maxlength="10"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                  onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                <mat-error *ngIf="gstDetails['controls'].gstinRegisteredMobileNumber.hasError('pattern')">
                  Please enter valid mobile no.</mat-error>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'Email ID'" [type]="'text'" [name]="merchantData.emailAddress"
                [placeholder]="'Email ID'" [value]="merchantData.emailAddress"  
                (sendValue)="merchantData.emailAddress = $event" [disabled]="true"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Email ID</mat-label>
                <input placeholder="Email ID" [(ngModel)]="merchantData.emailAddress"
                  [ngModelOptions]="{standalone: true}" [disabled]="true" matInput>
              </mat-form-field>
            </div>
          </div>


          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input [label]="'Sales Invoice Prefix'" [type]="'text'"
                [name]="merchantData.gstDetails.salesInvoicePrefix" [placeholder]="'E.g. SSBA /2018-2019/'"
                [value]="merchantData.gstDetails.salesInvoicePrefix"
                (sendValue)="merchantData.gstDetails.salesInvoicePrefix = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Sales Invoice Prefix</mat-label>
                <input placeholder="E.g. SSBA /2018-2019/" maxlength="50" formControlName="salesInvoicePrefix" matInput>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input-select [label]="'GSTR1'" [value]="merchantData.gstDetails.gstr1Type" [type]="'text'"
                [name]="'GSTR1'" [filter_items]="['MONTHLY','QUARTERLY']"
                (sendValue)="merchantData.gstDetails.gstr1Type = $event">
              </app-input-select> -->
              <mat-form-field appearance="outline">
                <mat-label>GSTR1</mat-label>
                <mat-select placeholder="GSTR1" formControlName="gstr1Type" required>
                  <mat-option *ngFor="let type of gstr1List" [value]="type.value">
                    {{type.label}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4">
              <!-- <app-input-select [label]="'GST Type'" [value]="merchantData.gstDetails.gstType" [type]="'text'"
                [name]="'GSTR1'" [filter_items]="['REGULAR', 'COMPOSITE']"
                (sendValue)="merchantData.gstDetails.gstType = $event">
              </app-input-select> -->
              <mat-form-field appearance="outline">
                <mat-label>GST Type</mat-label>
                <mat-select placeholder="GST Type" formControlName="gstType" required>
                  <mat-option *ngFor="let type of gstType" [value]="type.value">
                    {{type.label}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card__title">Bank information</div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4" formGroupName="bankInformation">
              <!-- <app-input [label]="'IFSC Code'" [type]="'text'" [name]="merchantData.gstDetails.bankInformation.ifscCode"
                [placeholder]="'IFSC Code'" [value]="merchantData.gstDetails.bankInformation.ifscCode"
                [is_capital]="true" (sendValue)="onEnterIFSCCode($event);"
                (inputFocusOut)="onFoucusOutOfIFSCCode($event)"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>IFSC Code</mat-label>
                <input placeholder="IFSC Code" maxlength="11" formControlName="ifscCode" matInput
                  (blur)="onEnterIFSCCode($event);" type="text" upperCase>
                <mat-error *ngIf="gstDetails['controls'].bankInformation['controls'].ifscCode.hasError('pattern')">
                  Please enter valid IFSC code.</mat-error>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4" formGroupName="bankInformation">
              <!-- <app-input [label]="'Bank Name'" [type]="'text'" [name]="merchantData.gstDetails.bankInformation.bankName"
                [placeholder]="'Bank Name'" [value]="merchantData.gstDetails.bankInformation.bankName"
                (sendValue)="merchantData.gstDetails.bankInformation.bankName = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Bank Name</mat-label>
                <input placeholder="Bank Name" maxlength="50" formControlName="bankName" matInput>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4" formGroupName="bankInformation">
              <!-- <app-input [label]="'Bank Branch'" [type]="'text'"
                [name]="merchantData.gstDetails.bankInformation.accountBranch" [placeholder]="'Bank Branch'"
                [value]="merchantData.gstDetails.bankInformation.accountBranch"
                (sendValue)="merchantData.gstDetails.bankInformation.accountBranch = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Bank Branch</mat-label>
                <input placeholder="Bank Branch" maxlength="50" formControlName="accountBranch" matInput>
              </mat-form-field>
            </div>
          </div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4" formGroupName="bankInformation">
              <!-- <app-input [label]="'Account Number'" [type]="'text'"
                [name]="merchantData.gstDetails.bankInformation.accountNumber" [placeholder]="'Account Number'"
                [value]="merchantData.gstDetails.bankInformation.accountNumber"
                (sendValue)="merchantData.gstDetails.bankInformation.accountNumber = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Account Number</mat-label>
                <input placeholder="Account Number" maxlength="18" formControlName="accountNumber" matInput
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                  onkeypress="return event.charCode >= 48 && event.charCode <= 57" matInput>
              </mat-form-field>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card__title">Address information</div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-4" formGroupName="businessAddress">
              <!-- <app-input [label]="'Business Address'" [type]="'text'"
                [name]="merchantData.gstDetails.businessAddress.address" [placeholder]="'Business Address'"
                [value]="merchantData.gstDetails.businessAddress.address"
                (sendValue)="merchantData.gstDetails.businessAddress.address = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Business Address</mat-label>
                <input placeholder="Business Address" maxlength="50" formControlName="address" matInput>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4" formGroupName="businessAddress">
              <!-- <app-input-select-object [label]="'Select State'" [type]="'text'" [value]="selected_gst_state"
                [name]="'state s'" [filter_items]="state_list" (sendValue)="onSelectGSTState($event)">
              </app-input-select-object> -->
              <mat-form-field appearance="outline">
                <mat-label>Select State</mat-label>
                <mat-select placeholder="Select State" formControlName="state">
                  <mat-option *ngFor="let type of state_list" [value]="type.stateMasterCode">
                    {{type.stateMasterName}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>

            <div class="card__col-xs-12 card__col-sm-4" formGroupName="businessAddress">
              <!-- <app-input [label]="'Pincode'" [type]="'text'" [name]="merchantData.gstDetails.businessAddress.pincode"
                [placeholder]="'Pincode'" [value]="merchantData.gstDetails.businessAddress.pincode"
                (sendValue)="merchantData.gstDetails.businessAddress.pincode = $event"></app-input> -->
              <mat-form-field appearance="outline">
                <mat-label>Pincode</mat-label>
                <input placeholder="Pincode" maxlength="6" formControlName="pincode"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                  onkeypress="return event.charCode >= 48 && event.charCode <= 57" matInput>
                <mat-error *ngIf="gstDetails['controls'].businessAddress['controls'].pincode.hasError('pattern')">
                  Please enter valid PIN code.</mat-error>
              </mat-form-field>
            </div>
          </div>
        </div>

        <!-- Business Logo Container -->
        <div class="ogp_images card card_main">
          <ngx-loading [show]="bLogoLoader"></ngx-loading>
          <div class="card__title">Business Logo</div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <app-input-upload [upload]="upload" [input_id]="merchantData.gstDetails.s3BusinessLogo"
                (filesDropped)="setBusinessLogo($event)"></app-input-upload>
            </div>

            <div class="wrapper" style="padding-top: 0;">
              <div class="container">
                <div class="card__col-xs-6 card__col-sm-6">
                  <div class="image" *ngIf="merchantData.gstDetails.s3BusinessLogo">
                    <img src="{{merchantData.gstDetails.s3BusinessLogo}}" alt="" class="image__item">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Business Logo Container -->

        <!-- Business Signature Container -->
        <div class="ogp_images card card_main" style="margin-left: 5px;margin-right: 0px">
          <ngx-loading [show]="bSignatureLoader"></ngx-loading>
          <div class="card__title">Business Signature</div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <app-input-upload [upload]="upload" [input_id]="merchantData.gstDetails.s3BusinessSignature"
                (filesDropped)="setBusinessSignature($event)"></app-input-upload>
            </div>

            <div class="wrapper" style="padding-top: 0;">
              <div class="container">
                <div class="card__col-xs-6 card__col-sm-6">
                  <div class="image" *ngIf="merchantData.gstDetails.s3BusinessSignature">
                    <img src="{{merchantData.gstDetails.s3BusinessSignature}}" alt="" class="image__item">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Business Signature Container -->

        <!-- GST Certificate Container -->
        <div class="ogp_images card card_main">
          <ngx-loading [show]="gstCertLoader"></ngx-loading>
          <div class="card__title">GST Certificate</div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <app-input-upload [upload]="upload" [input_id]="merchantData.gstDetails.s3GstCertificate"
                (filesDropped)="setGSTCertificate($event)"></app-input-upload>
            </div>

            <div class="wrapper" style="padding-top: 0;">
              <div class="container">
                <div class="card__col-xs-6 card__col-sm-6" style="text-align: center;">
                  <div class="image" *ngIf="merchantData.gstDetails.s3GstCertificate">
                    <img src="{{merchantData.gstDetails.s3GstCertificate}}" alt="" class="image__item"
                      *ngIf="merchantData.gstDetails.s3GstCertificate.indexOf('.pdf') == -1">
                    <div *ngIf="merchantData.gstDetails.gstCertificate.indexOf('.pdf') != -1" class="pdf-view">
                      <a class="btn" (click)="viewUrl(merchantData.gstDetails.s3GstCertificate);">View</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- GST Certificate Container -->

        <div class="ogp_images gst-btns-card card card_main">
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <a class="btn" (click)="getITCLedgerDetails();">ITC Ledger</a>
            </div>
            <div class="card__col-xs-12 card__col-sm-6">

            </div>
          </div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <a class="btn" (click)="getLiabilityLedgerDetails();">Liability Ledger</a>
            </div>
            <div class="card__col-xs-12 card__col-sm-6">

            </div>
          </div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <a class="btn" (click)="getCashITCBalance();">Cash ITC Balance</a>
            </div>
            <div class="card__col-xs-12 card__col-sm-6">

            </div>
          </div>
        </div>

        <!-- Opening Balance -->
        <div class="ogp_images card card_main">
          <ngx-loading [show]="gstCertLoader"></ngx-loading>
          <div class="card__title">GST Opening Balance</div>
          <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-6">
              <app-input-select-object [label]="'Select Return Date'" [type]="'text'"
                [value]="selected_gst_return_calendars_data" [type]="'text'"
                [name]="'selected_gst_return_calendars_data'" [filter_items]="gst_return_calendars_data"
                (sendValue)="onSelectGSTReturnCalendar($event)">
              </app-input-select-object>
            </div>

            <div class="card__col-xs-12 card__col-sm-6  text-pull-right">
              <a class="btn long-btn" (click)="getOpeningBalance();">Get Credit</a>
            </div>
          </div>
          <div class="card__row">
            <div class="report-table-wrapper">
              <table class="report-table" style="min-width: unset;">
                <thead class="report-table__head">
                  <tr class="report-table__row report-table__row_head">
                    <th class="report-table__cell report-table__cell_name text-pull-left" style="width: 180px;"></th>
                    <th class="report-table__cell report-table__cell_name text-pull-right">Op. Bal. of Credit</th>
                  </tr>
                </thead>
                <tbody class="report-table__body">
                  <tr class="report-table__row">
                    <td class="report-table__cell report-table__cell_name text-pull-left">IGST</td>
                    <td class="report-table__cell report-table__cell_day text-pull-right">
                      <app-input [label]="''" [type]="'number'" [name]="'opbcreditigst'" [placeholder]="''"
                        [value]="opBalCreditObj.igst" (sendValue)="opBalCreditObj.igst = $event;"
                        [is_only_positive_number_allowed]="true"></app-input>
                    </td>
                  </tr>

                  <tr class="report-table__row">
                    <td class="report-table__cell report-table__cell_name text-pull-left">CGST</td>
                    <td class="report-table__cell report-table__cell_day text-pull-right">
                      <app-input [label]="''" [type]="'number'" [name]="'opbcreditcgst'" [placeholder]="''"
                        [value]="opBalCreditObj.cgst" (sendValue)="opBalCreditObj.cgst = $event;"
                        [is_only_positive_number_allowed]="true"></app-input>
                    </td>
                  </tr>

                  <tr class="report-table__row">
                    <td class="report-table__cell report-table__cell_name text-pull-left">SGST/UTGST</td>
                    <td class="report-table__cell report-table__cell_day text-pull-right">
                      <app-input [label]="''" [type]="'number'" [name]="'opbcreditsgst'" [placeholder]="''"
                        [value]="opBalCreditObj.sgst" (sendValue)="opBalCreditObj.sgst = $event;"
                        [is_only_positive_number_allowed]="true"></app-input>
                    </td>
                  </tr>

                  <tr class="report-table__row">
                    <td class="report-table__cell report-table__cell_name text-pull-left">CESS</td>
                    <td class="report-table__cell report-table__cell_day text-pull-right">
                      <app-input [label]="''" [type]="'number'" [name]="'opbcreditcess'" [placeholder]="''"
                        [value]="opBalCreditObj.cess" (sendValue)="opBalCreditObj.cess = $event;"
                        [is_only_positive_number_allowed]="true"></app-input>
                    </td>
                  </tr>

                  <tr class="report-table__row">
                    <td class="report-table__cell report-table__cell_name text-pull-left">LATE FEE</td>
                    <td class="report-table__cell report-table__cell_day text-pull-right">
                      <app-input [label]="''" [type]="'number'" [name]="'opbcreditlatefee'" [placeholder]="''"
                        [value]="opBalCreditObj.lateFee" (sendValue)="opBalCreditObj.lateFee = $event;"
                        [is_only_positive_number_allowed]="true"></app-input>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="card__row text-pull-right">
            <div class="card__col-xs-12 card__col-sm-12">
              <a class="btn long-btn" (click)="saveGstOpeningBalance();">Save Credit</a>
            </div>
          </div>
        </div>
        <!-- Opening Balance -->

        <!-- Terms and Conditions -->
        <div class="ogp_images gst-btns-card ">
          <div class="card card_main">
            <div class="card__title">Opening Balance(User Onboarding)</div>
            <div class="card__row">
              <div class="card__col-xs-12">
                <app-input [label]="'Purchase Value'" [type]="'text'"
                  [name]="merchantData.gstDetails.openingPurchaseValue" [placeholder]="'Opening Purchase Value'"
                  [value]="merchantData.gstDetails.openingPurchaseValue" [is_capital]="true"
                  (sendValue)="merchantData.gstDetails.openingPurchaseValue = $event"></app-input>
              </div>
              <div class="card__col-xs-12" style="padding-top: 10px;">
                <app-input [label]="'Sales Value'" [type]="'text'" [name]="merchantData.gstDetails.openingSalesValue"
                  [placeholder]="'Opening Sales Value'" [value]="merchantData.gstDetails.openingSalesValue"
                  (sendValue)="merchantData.gstDetails.openingSalesValue = $event"></app-input>
              </div>
            </div>
          </div>
          <div class="card card_main">
            <div class="card__title">Terms and Conditions</div>
            <div class="card__row">
              <div class="card__col-xs-12">
                <textarea rows="10" style="width: 100%;" class="input__text"
                  placeholder="You can add your personalised business terms and conditions."
                  maxLength="1000"></textarea>
              </div>
            </div>
          </div>
        </div>
        <!-- Terms and Conditions -->

        <div class="footer__buttons clearfix" style="margin-top: 40px;">
          <!-- <a type="button" class="btn long-btn" (click)="saveBusinessProfile();">Save Profile</a> -->

          <button class="btn long-btn" style="border: none;" (click)="saveBusinessProfile()">Save Profile</button>
        </div>
        <!-- .footer__buttons -->
      </form>
    </ng-template>


  </div><!-- .content__container -->
</div><!-- .content -->