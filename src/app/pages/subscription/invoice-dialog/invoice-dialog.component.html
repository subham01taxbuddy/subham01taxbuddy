<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px',fullScreenBackdrop:true }"></ngx-loading>
<h1 mat-dialog-title>{{data.title}}</h1>

<form [formGroup]="invoiceEditForm">
    <mat-dialog-content>
        <div class="card__row">
            <div class="card__col-lg-6">
                <mat-card style="min-height: 130px; font-size: 16px;line-height: 20px;">
                    Bill To: {{invoiceEditForm.value.billTo}}<br>
                    Phone: {{invoiceEditForm.value.phone}}<br>
                    Email: {{invoiceEditForm.value.email}}<br>
                    Due Date: {{invoiceEditForm.value.dueDate | date:'mediumDate'}}<br>
                </mat-card>
            </div>
            <div class="card__col-lg-6">
                <mat-card style="min-height: 130px; font-size: 16px;line-height: 20px;">
                    Sub Total: {{invoiceEditForm.value.subTotal}}<br>
                    <span *ngIf="invoiceEditForm.value.discountTotal">Discount Applied:
                        {{invoiceEditForm.value.discountTotal}}<br></span>
                    <span *ngIf="invoiceEditForm.value.state === 'Maharashtra'"> CGST:
                        {{invoiceEditForm.value.cgstTotal}}<br></span>
                    <span *ngIf="invoiceEditForm.value.state === 'Maharashtra'">SGST:
                        {{invoiceEditForm.value.sgstTotal}}<br></span>
                    <span *ngIf="invoiceEditForm.value.state !== 'Maharashtra'">IGST:
                        {{invoiceEditForm.value.igstTotal}}<br></span>
                    Total: {{invoiceEditForm.value.total}}<br>
                </mat-card>
            </div>
        </div>
        <br>
        <br>

        <div class="card__col-xs-4 card__col-sm-4">
            <mat-form-field appearance="outline">
                <mat-label>Payment Status</mat-label>
                <mat-select formControlName="paymentStatus" matInput placeholder="Select Payment Status"
                    autocomplete="off" required>
                    <mat-option value="Paid">Paid</mat-option>
                    <mat-option value="Failed">Failed</mat-option>
                    <mat-option value="Unpaid">Unpaid</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-4">
            <mat-form-field appearance="outline">
                <mat-label>Mode of Payment</mat-label>
                <mat-select formControlName="modeOfPayment" matInput placeholder="Select Mode of Payment"
                    autocomplete="off" required>
                    <mat-option value="Bank Transfer">Bank Transfer</mat-option>
                    <mat-option value="Google Pay">Google Pay</mat-option>
                    <mat-option value="Phone Pay">Phone Pay</mat-option>
                    <mat-option value="Paytm">Paytm</mat-option>
                    <mat-option value="Cash">Cash</mat-option>
                </mat-select>
                <mat-error *ngIf="invoiceEditForm.controls['modeOfPayment'].hasError('required')">Select
                    Mode of Payment
                </mat-error>
            </mat-form-field>
        </div>

        <div class="card__col-xs-4 card__col-sm-4" *ngIf="invoiceEditForm.controls['modeOfPayment'].value === 'Cash'">
            <mat-form-field appearance="outline">
                <mat-label>Payment Collected By</mat-label>
                <input matInput formControlName="paymentCollectedBy" placeholder="Payment Collected By"
                    autocomplete="off" maxlength="15"
                    [required]="invoiceEditForm.controls['modeOfPayment'].value === 'Cash'">
                <mat-error *ngIf="invoiceEditForm.controls['paymentCollectedBy'].hasError('required')">Enter
                    payment collected by
                </mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-4" *ngIf="invoiceEditForm.controls['modeOfPayment'].value !== 'Cash'">
            <mat-form-field appearance="outline">
                <mat-label>Transaction Id</mat-label>
                <input matInput formControlName="transactionId" placeholder="Transaction Id" autocomplete="off"
                    maxlength="15" [required]="invoiceEditForm.controls['modeOfPayment'].value !== 'Cash'">
                <mat-error *ngIf="invoiceEditForm.controls['transactionId'].hasError('required')">Enter
                    Transaction Id
                </mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-4">
            <mat-form-field appearance="outline">
                <mat-label>Date of receipt</mat-label>
                <input matInput formControlName="dateOfReceipt" [matDatepicker]="picker3" required [max]="maxDate"
                    (dateChange)="setDepositInBankValidation(invoiceEditForm.controls['dateOfReceipt'].value)"
                    autocomplete="off">
                <mat-datepicker-toggle matSuffix [for]="picker3"></mat-datepicker-toggle>
                <mat-datepicker #picker3></mat-datepicker>
                <mat-error *ngIf="invoiceEditForm.controls['dateOfReceipt'].hasError('required')">Select
                    date of receipt</mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-4">
            <mat-form-field appearance="outline">
                <mat-label>Date of deposite</mat-label>
                <input matInput formControlName="dateOfDeposit" [matDatepicker]="picker4" [min]="minDepositInBank"
                    [max]="maxDate" autocomplete="off" required>
                <mat-datepicker-toggle matSuffix [for]="picker4"></mat-datepicker-toggle>
                <mat-datepicker #picker4></mat-datepicker>
                <mat-error *ngIf="invoiceEditForm.controls['dateOfDeposit'].hasError('required')">
                    Select date of deposite</mat-error>
            </mat-form-field>
        </div>
    </mat-dialog-content>
    <mat-dialog-actions align="center">
        <button mat-raised-button color="primary" (click)="updateInvoice()" tabindex="1">{{data.submitBtn}}</button>
        <button mat-raised-button mat-dialog-close tabindex="-1">Cancel</button>
    </mat-dialog-actions>
</form>