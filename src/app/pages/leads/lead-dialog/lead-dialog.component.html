<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px',fullScreenBackdrop:true }"></ngx-loading>
<h1 mat-dialog-title>{{data.title}}</h1>

<mat-dialog-content *ngIf="showTable">
    <table *ngIf="data.mode === 'source'">  <!--leadSourceInfo.length > 0-->
        <tr>
            <th><b>Source Name</b></th>
            <th><b>Created Date</b></th>
        </tr>
        <tr *ngFor="let source of leadSourceInfo">
            <td>{{source.name}}</td>
            <td>{{source.createdDate | date: 'dd/MM/yyyy, hh:mm a'}}</td>
        </tr>
    </table>

    <table *ngIf="data.mode === 'status'"> <!--leadStatusInfo.length > 0-->
        <tr>
            <th><b>Status</b></th>
            <th><b>Created Date</b></th>
            <th><b>Follow Up Date</b></th>
        </tr>
        <tr *ngFor="let status of leadStatusInfo">
            <td>{{status.status}}</td>
            <td>{{status.createdDate | date: 'dd/MM/yyyy, hh:mm a'}}</td>
            <td>{{status.followUpDate | date: 'dd/MM/yyyy, hh:mm a'}}</td>
        </tr>
    </table>

</mat-dialog-content>
<mat-dialog-actions align="center" *ngIf="showTable">
    <!-- <button mat-raised-button color="primary"  (click)="updateLeadStatus()" tabindex="1">Update Status</button> -->
    <button mat-raised-button mat-dialog-close tabindex="-1">Cancel</button>
</mat-dialog-actions>

<form [formGroup]="leadStatusForm" *ngIf="!showTable && data.mode === 'update-status'">
    <mat-dialog-content>
        <div class="card__col-xs-4 card__col-sm-14">
            <mat-form-field appearance="outline" >
                <mat-label>Select Status</mat-label>
                <mat-select placeholder="Select Status" formControlName="leadStatus" required>
                    <mat-option *ngFor="let status of fillingStatus" [disabled]="status.disable" [value]="status.value">
                        {{ status.key }}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="leadStatusForm.controls['leadStatus'].hasError('required')">Select status.</mat-error>
            </mat-form-field>
        </div>
       
         <div class="card__col-xs-4 card__col-sm-14" *ngIf="leadStatusForm.controls['leadStatus'].value === 'FOLLOWUP'">
            <mat-form-field appearance="outline">
                <mat-label>Schedule Call Date & Time</mat-label> 
                <input matInput formControlName="callSheduleDate" [owlDateTimeTrigger]="dtPicker2" [min]="minDate" 
                    [owlDateTime]="dtPicker2" [required]="leadStatusForm.controls['leadStatus'].value === 'FOLLOWUP'">  <!--[required]="callLogForm.controls['statusId'].value === 17"-->
                <owl-date-time #dtPicker2></owl-date-time>
                <mat-error *ngIf="leadStatusForm.controls['callSheduleDate'].hasError('required')">Select Schedule Date & Time.</mat-error>
            </mat-form-field>
        </div>

        <div class="card__col-xs-4 card__col-sm-14" *ngIf="leadStatusForm.controls['leadStatus'].value === 'AUTO_FOLLOWUP'">
            <mat-form-field appearance="outline" >
                <mat-label>Select Source</mat-label>
                <mat-select placeholder="Select Source" formControlName="source" [required]="leadStatusForm.controls['leadStatus'].value === 'AUTO_FOLLOWUP'">
                    <mat-option *ngFor="let source of sourceInfo"  [value]="source.name">
                        {{ source.name }}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="leadStatusForm.controls['source'].hasError('required')">Select source.</mat-error>
            </mat-form-field>
        </div>

    </mat-dialog-content>

    <mat-dialog-actions align="center">
        <button mat-raised-button color="primary"  (click)="updateLeadStatus()" tabindex="1">Update</button>

        <button mat-raised-button mat-dialog-close tabindex="-1">Cancel</button>
    </mat-dialog-actions>
</form>

<form [formGroup]="agentIdForm" *ngIf="data.mode === 'update-aginId'">
    <mat-dialog-content >
        <div class="card__col-xs-4 card__col-sm-14">
            <mat-form-field appearance="outline" >
                <mat-label>Agent Id</mat-label>
                <input matInput formControlName="agentId" placeholder="Enter Agent Id" required>
                <mat-error *ngIf="agentIdForm.controls['agentId'].hasError('required')">Enter Agent Id.</mat-error>
                <mat-error *ngIf="agentIdForm.controls['agentId'].hasError('pattern')">Enter Valid Agent Id.</mat-error>
            </mat-form-field>
        </div>
    </mat-dialog-content>
    
    <mat-dialog-actions align="center" >
        <button mat-raised-button color="primary"  (click)="updateAgentId()" tabindex="1">Update Agent Id</button>
    
        <button mat-raised-button mat-dialog-close tabindex="-1">Cancel</button>
    </mat-dialog-actions>
    
</form>


<form [formGroup]="leadForm"  *ngIf="data.mode === 'partnerLead' || data.mode === 'gstLead'"> 
    <mat-dialog-content >
        <div class="card__col-xs-4 card__col-sm-14">
            <mat-form-field appearance="outline" >
                <mat-label>Company/Partnership/Proprietor Name</mat-label>
                <input matInput  placeholder="Enter Name" formControlName="name" maxlength="100" required>
                <mat-error *ngIf="leadForm.controls['name'].hasError('required')">Enter name.</mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-14">
            <mat-form-field appearance="outline" >
                <mat-label>Email Address</mat-label>
                <input matInput  placeholder="Enter Email Id" formControlName="email" maxlength="50">
                <mat-error *ngIf="leadForm.controls['email'].hasError('required')">Enter email.</mat-error>
                <mat-error *ngIf="leadForm.controls['email'].hasError('pattern')">Enter valid email.</mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-14">
            <mat-form-field appearance="outline" >
                <mat-label>Mobile Number</mat-label>
                <input matInput  placeholder="Enter Mobile Number" maxlength="10" formControlName="mobileNo"
                    autocomplete="off" type="number"
                    oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                    onkeypress="return event.charCode >= 48 && event.charCode <= 57" required>
                <mat-error *ngIf="leadForm.controls['mobileNo'].hasError('required')">Enter mobile number.</mat-error>
                <mat-error *ngIf="leadForm.controls['mobileNo'].hasError('pattern')">Enter valid mobile number.</mat-error>
            </mat-form-field>
        </div>

        <div class="card__col-xs-4 card__col-sm-14">
            <mat-form-field appearance="outline" >
                <mat-label>City in India</mat-label>
                <mat-select placeholder="Select city" formControlName="city">
                    <mat-option *ngFor="let city of indianCity" [value]="city.name">
                        {{ city.name }}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="leadForm.controls['city'].hasError('required')">Select city.</mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-14" *ngIf="data.mode === 'partnerLead'">
            <mat-form-field appearance="outline" >
                <mat-label>How did you hear about us?</mat-label>
                <mat-select placeholder="Select" formControlName="hearAboutUs" [required]="data.mode === 'partnerLead'">
                    <mat-option *ngFor="let obj of hearABoutUs" [value]="obj.value">
                        {{ obj.key }}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="leadForm.controls['hearAboutUs'].hasError('required')">Select option.</mat-error>
            </mat-form-field>
        </div>
        <div class="card__col-xs-4 card__col-sm-14" *ngIf="data.mode === 'partnerLead'">
            <mat-form-field appearance="outline" >
                <mat-label>Website</mat-label>
                <input matInput formControlName="website" placeholder="http://www.example.com">
                <!-- <mat-error *ngIf="agentIdForm.controls['agentId'].hasError('required')">Enter Agent Id.</mat-error> -->
            </mat-form-field>
        </div>

        <div class="card__col-xs-4 card__col-sm-14" >
            <mat-form-field appearance="outline" >
                <mat-label>Channel</mat-label>
                <input matInput formControlName="channel" placeholder="Enter Channel">
                <!-- <mat-error *ngIf="agentIdForm.controls['agentId'].hasError('required')">Enter Agent Id.</mat-error> -->
            </mat-form-field>
        </div>

        <div class="card__col-xs-4 card__col-sm-14" >
            <mat-form-field appearance="outline">
                <mat-label>Lead Created Date</mat-label>
                <input matInput formControlName="leadCreatedDate" [matDatepicker]="picker1" [max]="maxDate"
                    autocomplete="off" >
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
                <!-- <mat-error *ngIf="leadsForm.controls['fromDate'].hasError('required')">Select From
                    date</mat-error> -->
            </mat-form-field>
        </div>

        <div class="card__col-xs-12 card__col-sm-14" *ngIf="data.mode === 'gstLead'">
                <label><b>I am here for: </b></label>  <span style="color: red;"> *</span><br>
                <mat-radio-group aria-label="I am here for" formControlName="gstSubSurvice" [required]="data.mode === 'gstLead'">
                    <mat-radio-button value="gstRegistration">GST Registration</mat-radio-button> &nbsp;
                    <mat-radio-button value="gstReturnFiling">GST Returns Filing & Compliance</mat-radio-button>&nbsp;
                    <mat-radio-button value="other">Others</mat-radio-button>
                </mat-radio-group>
        </div>

        <div class="card__col-xs-12 card__col-sm-14" style="margin-top: 18px;" *ngIf="data.mode === 'partnerLead'">
            <label><b>Your Interest Area:</b></label> <span style="color: red;"> *</span><br>
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[0].value"> {{intersetAreaArray[0].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[1].value"> {{intersetAreaArray[1].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[2].value"> {{intersetAreaArray[2].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[3].value"> {{intersetAreaArray[3].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[4].value"> {{intersetAreaArray[4].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[5].value"> {{intersetAreaArray[5].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[6].value"> {{intersetAreaArray[6].key}} &nbsp;
            <input type="checkbox" (change)="onCheckboxChange($event)" [value]="intersetAreaArray[7].value"> {{intersetAreaArray[7].key}}
        </div>
     
        <div class="card__col-xs-12 card__col-sm-14" style="margin-top: 18px;" *ngIf="data.mode === 'partnerLead'">
            <mat-form-field appearance="outline" >
                <mat-label>Other Information</mat-label>
                <textarea matInput formControlName="otherInfo" placeholder="Enter Other information" > </textarea>
                <!-- <mat-error *ngIf="agentIdForm.controls['agentId'].hasError('required')">Enter Agent Id.</mat-error> -->
            </mat-form-field>
        </div>

       
    </mat-dialog-content>
    
    <mat-dialog-actions align="center" >
        <button mat-raised-button color="primary"  (click)="addLeadInfo()" tabindex="1">Add Lead</button>
    
        <button mat-raised-button mat-dialog-close tabindex="-1">Cancel</button>
    </mat-dialog-actions>
    
</form>