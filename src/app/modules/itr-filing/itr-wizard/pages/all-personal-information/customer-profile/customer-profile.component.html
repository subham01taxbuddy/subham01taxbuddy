<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px',fullScreenBackdrop:true }"></ngx-loading>

<div class="card">
    <form [formGroup]="customerProfileForm">
        <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>PAN Number</mat-label>
                    <input type="text" matInput placeholder="PAN" name="panNumber" formControlName="panNumber"
                        class="input-field" maxlength="10" minlength="10"
                        (blur)="getUserDataByPan(customerProfileForm.controls['panNumber'].value)" required upperCase>
                    <mat-error *ngIf="customerProfileForm.controls['panNumber'].hasError('pattern')">
                        Enter valid PAN (e.g XXXXX1234X)</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['panNumber'].hasError('required')">
                        Enter PAN Number.</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Mobile</mat-label>
                    <input matTooltip="Mobile number should be of 10 digit." matTooltipClass="tab-tooltip"
                        matTooltipPosition="above" maxlength="10" minlength="10" matInput placeholder="Mobile"
                        name="mobile" formControlName="contactNumber" class="input-field" digitsOnly required>
                    <mat-error
                        *ngIf="customerProfileForm.controls['contactNumber'].hasError('required') || customerProfileForm.controls['contactNumber'].hasError('pattern') || customerProfileForm.controls['contactNumber'].hasError('minlength') || customerProfileForm.controls['contactNumber'].hasError('maxlength')">
                        Enter
                        10 digit mobile number</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Email</mat-label>
                    <input matInput placeholder="Email address" name="email" formControlName="email" class="input-field"
                        maxlength="50" required>
                    <mat-error *ngIf="customerProfileForm.controls['email'].hasError('pattern')">Enter
                        valid email</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['email'].hasError('required')">Enter
                        email</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Aadhaar Number</mat-label>
                    <input matTooltip="Aadhar Number should be linked with your PAN Number and 12 digit."
                        matTooltipClass="tab-tooltip" matTooltipPosition="above" matInput currencyMask
                        placeholder="Aadhaar" name="aadharNumber" formControlName="aadharNumber" class="input-field"
                        maxlength="12" digitsOnly required>
                    <mat-error *ngIf="customerProfileForm.controls['aadharNumber'].hasError('required')">
                        Enter aadhar number</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['aadharNumber'].hasError('maxlength')">
                        Enter
                        12 digit aadhar number</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['aadharNumber'].hasError('minlength')">
                        Enter
                        12 digit aadhar number</mat-error>
                </mat-form-field>
            </div>
        </div>
        <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>First name</mat-label>
                    <input type="text" matTooltip="First name as per PAN" [pattern]="charRegex"
                        matTooltipClass="tab-tooltip" matTooltipPosition="above" matInput currencyMask
                        placeholder="First name" name="FirstName" formControlName="firstName" class="input-field"
                        maxlength="25" capitalizeFirst>
                    <mat-error *ngIf="customerProfileForm.controls['firstName'].hasError('pattern')">
                        Enter
                        character only</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Middle name</mat-label>
                    <input type="text" matTooltip="Middle name as per PAN" [pattern]="charRegex"
                        matTooltipClass="tab-tooltip" matTooltipPosition="above" matInput currencyMask
                        placeholder="Middle name" name="MiddleName" formControlName="middleName" class="input-field"
                        maxlength="75" capitalizeFirst>
                    <mat-error *ngIf="customerProfileForm.controls['middleName'].hasError('pattern')">
                        Enter
                        character only</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Last name</mat-label>
                    <input type="text" matTooltip="Last name as per PAN" [pattern]="charRegex"
                        matTooltipClass="tab-tooltip" matTooltipPosition="above" matInput currencyMask
                        placeholder="Last name" name="LastName" formControlName="lastName" class="input-field"
                        maxlength="75" capitalizeFirst required>
                    <mat-error *ngIf="customerProfileForm.controls['lastName'].hasError('pattern')">
                        Enter
                        character only</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['lastName'].hasError('required')">
                        Enter last name.</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Date Of Birth</mat-label>
                    <input matTooltip="Date of birth as per PAN" matTooltipClass="tab-tooltip"
                        matTooltipPosition="above" matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker"
                        class="input-field" placeholder="Date of birth" name="dateOfBirth" 
                        [formControl]="customerProfileForm.controls['dateOfBirth']" required>
                    <mat-hint>Format: DD/MM/YYYY</mat-hint>
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                    <mat-error *ngIf="customerProfileForm.controls['dateOfBirth'].hasError('required')">
                        Select date of birth</mat-error>
                </mat-form-field>
            </div>
        </div>

        <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Father Name</mat-label>
                    <input type="text" matInput placeholder="Father's name" name="mobile"
                        [formControl]="customerProfileForm.controls['fatherName']" [pattern]="charRegex"
                        class="input-field" maxlength="125" capitalizeFirst required>
                    <mat-error *ngIf="customerProfileForm.controls['fatherName'].hasError('pattern')">
                        Enter character only</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['fatherName'].hasError('required')">
                        Enter father name</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Residential status</mat-label>
                    <mat-select placeholder="Residential status" name="residentialStatus"
                        (selectionChange)="onSelectResidential(customerProfileForm.controls['residentialStatus'].value)"
                        [formControl]="customerProfileForm.controls['residentialStatus']" required>
                        <mat-option *ngFor="let res of residentialStatus" [value]="res.value">
                            {{ res.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Employer Category</mat-label>
                    <mat-select placeholder="Employer Category" name="employerCategory"
                        formControlName="employerCategory" required>
                        <mat-option *ngFor="let emp of employersDropdown" [value]="emp.value">
                            {{ emp.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Select Gender</mat-label>
                    <mat-select placeholder="Select Gender" name="gender" formControlName="gender">
                        <mat-option *ngFor="let gender of genderMaster" [value]="gender.value">
                            {{ gender.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <div class="card__row">
            <div class="card__col-xs-12 card__col-sm-3">
                <mat-form-field appearance="outline">
                    <mat-label>Return Type</mat-label>
                    <mat-select placeholder="Return Type" name="isRevised" formControlName="isRevised"
                        (selectionChange)="changeReviseForm()" required>
                        <mat-option *ngFor="let type of returnTypes" [value]="type.value">
                            {{ type.label }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3" *ngIf="customerProfileForm.controls['isRevised'].value === 'Y'">
                <mat-form-field appearance="outline">
                    <mat-label>Acknowledgement number</mat-label>
                    <input matTooltip="Acknowledgement number maximum of 15 digit" matTooltipClass="tab-tooltip"
                        matTooltipPosition="above" matInput placeholder="Acknowledgement of Original ITR"
                        name="orgITRAckNum" digitsOnly class="input-field" maxlength="15" minlength="15"
                        formControlName="orgITRAckNum" />
                    <mat-error *ngIf="customerProfileForm.controls['orgITRAckNum'].hasError('required')">
                        Enter Acknowledgement number</mat-error>
                    <mat-error *ngIf="customerProfileForm.controls['orgITRAckNum'].hasError('minlength')">
                        Enter
                        15 digit Acknowledgement number</mat-error>
                </mat-form-field>
            </div>
            <div class="card__col-xs-12 card__col-sm-3" *ngIf="customerProfileForm.controls['isRevised'].value === 'Y'">
                <mat-form-field appearance="outline">
                    <mat-label>Date of filing</mat-label>
                    <input [max]="maxDateRevise" matInput [matDatepicker]="revisedPicker"
                        placeholder="Date of filing original return" name="orgITRDate" readonly
                        formControlName="orgITRDate" />
                    <mat-datepicker-toggle matSuffix [for]="revisedPicker"></mat-datepicker-toggle>
                    <mat-datepicker #revisedPicker></mat-datepicker>
                </mat-form-field>
            </div>
        </div>

        <div class="">

            <div class="card__row footer__buttons clearfix" style="margin-top: 40px;">
                <div style="text-align: left;">
                    <div class="card__col-xs-12 card__col-sm-4" style="text-align: left;">
                        <button class="tbd-btn" (click)="addClient()">Add Client </button>
                        <div style="margin-left: 15px;" *ngIf="navigationData?.eriClientValidUpto">Client added, valid
                            upto {{navigationData?.eriClientValidUpto | date}}</div>
                    </div>
                    <div class="card__col-xs-12 card__col-sm-4" style="text-align: left;">
                        <button class="tbd-btn" (click)="getPrefillData()">Get Prefill Data </button>
                        <div style="margin-left: 15px;" *ngIf="this.ITR_JSON?.prefillDate">Last
                            {{this.ITR_JSON?.prefillDataSource === 'UPLOAD' ? 'uploaded' : 'generated'}} on
                            {{this.ITR_JSON?.prefillDate | date}}</div>
                    </div>

                </div>
                <button class="tbd-btn-secondary" (click)="this.location.back()"><i class="fa fa-arrow-left"
                        aria-hidden="true"></i>
                    &nbsp;&nbsp;Back</button>
                <button class="tbd-btn" (click)="saveProfile('CONTINUE')">Save and Continue </button>
            </div>
        </div>
    </form>
</div>