<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px',fullScreenBackdrop:true }"></ngx-loading>
<div class="schedule-header"> Schedule Assets & Liability (AL)</div>
<mat-accordion class="headers-align">
  <mat-expansion-panel [expanded]="step === 1" step='1' hideToggle class="hide-close">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <mat-icon>
          arrow_forward_ios
        </mat-icon>
        A. Add details of Immovable Assets
      </mat-panel-title>
      <div class="card__row edit clearfix isShow">
        <button class="edit_btn" (click)="$event.stopPropagation();addMore()"><i class="fa fa-plus"></i>Add</button>
      </div>
    </mat-expansion-panel-header>
    <div class="card">
      <form [formGroup]="immovableAssetForm">
        <div formArrayName="immovableAssetArray">
          <div class="tds-on"
            *ngFor="let immovableAssets of immovableAssetArray.controls | paginate:config ;let i=index"
            [formGroupName]="fieldGlobalIndex(i)">
            <mat-checkbox color="primary" name="hasEdit[i]" formControlName="hasEdit" class="ml30">
            </mat-checkbox>
            <div class="card__col-xs-12 card__col-sm-12">
              <div class="card__col-xs-12 card__col-sm-6">
                <div class="card__col-sm-12">
                  <mat-label>Description</mat-label>
                  <mat-form-field class="description" appearance="outline">
                    <input type="text" trim matInput placeholder="Asset Description" name="description"
                      formControlName="description" class="input-field" maxlength="50" required>
                  </mat-form-field>
                </div>
              </div>
              <div class="card__col-xs-12 card__col-sm-6">
                <div class="card__col-sm-6">
                  <mat-label>Amount (Cost) *</mat-label>
                  <mat-form-field appearance="outline">
                    <input digitsOnly trim matInput placeholder="Amount" name="amount" formControlName="amount"
                      class="input-field" maxlength="50" required>
                  </mat-form-field>
                </div>
                <div class="card__col-sm-6">
                  <mat-label>PIN Code *</mat-label>
                  <mat-form-field appearance="outline">
                    <input type="text" matInput placeholder="PIN code" name="pinCode" formControlName="pinCode"
                      class="input-field" maxlength="6" minlength="6" trim digitsOnly
                      (blur)="updateDataByPincode(immovableAssets)" required>
                    <mat-error
                      *ngIf="immovableAssetForm.controls['immovableAssetArray'].controls[i].controls['pinCode'].hasError('pattern')">
                      Enter
                      6 digit PIN code.
                    </mat-error>
                    <mat-error
                      *ngIf="immovableAssetForm.controls['immovableAssetArray'].controls[i].controls['pinCode'].hasError('minLength') ">
                      Enter
                      6 digit PIN code.
                    </mat-error>
                    <mat-error
                      *ngIf="immovableAssetForm.controls['immovableAssetArray'].controls[i].controls['pinCode'].hasError('maxLength')">
                      Enter
                      6 digit PIN code.
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
              <div class="card__col-xs-12 card__col-sm-6">
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>Flat/Door/Block No *</mat-label>
                  <mat-form-field appearance="outline">
                    <input type="text" trim matInput placeholder="Flat/Door/Block No." name="flatNo"
                      formControlName="flatNo" class="input-field" maxlength="50" required>
                  </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>Premises name</mat-label>
                  <mat-form-field appearance="outline">
                    <input type="text" trim matInput placeholder="Premises name" name="premisesName"
                      formControlName="premisesName" class="input-field" maxlength="50">
                  </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>Road / Street</mat-label>
                  <mat-form-field appearance="outline">
                    <input type="text" trim matInput placeholder="Road / Street" name="road" formControlName="road"
                      class="input-field" maxlength="50">
                  </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>Area/ Locality *</mat-label>
                  <mat-form-field appearance="outline">
                    <input type="text" trim matInput placeholder="Area/ Locality" name="area" formControlName="area"
                      class="input-field" maxlength="50" required>
                  </mat-form-field>
                </div>
              </div>
              <div class="card__col-xs-12 card__col-sm-6">
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>City *</mat-label>
                  <mat-form-field appearance="outline">
                    <input type="text" trim matInput placeholder="City/Taluka/District" name="city"
                      formControlName="city" class="input-field" maxlength="50" required>
                    <mat-error
                      *ngIf="immovableAssetForm.controls['immovableAssetArray'].controls[i].controls['city'].hasError('pattern')">
                      Enter valid
                      city name.</mat-error>
                  </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>Select state *</mat-label>
                  <mat-form-field appearance="outline">
                    <mat-select placeholder="Select state" name="state" formControlName="state" required>
                      <mat-option *ngFor="let state of stateDropdown" [value]="state.stateCode">
                        {{ state.stateName | titlecase}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="card__col-xs-12 card__col-sm-6">
                  <mat-label>Select country *</mat-label>
                  <mat-form-field appearance="outline">
                    <mat-select placeholder="Select country" name="country" formControlName="country" required>
                      <mat-option *ngFor="let country of countryDropdown" [value]="country.countryCode">
                        {{ country.countryName | titlecase}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>
            <div class="edit-head">
              <button type="button" class="edit-donation" (click)="editAssetForm(i,'immovable')"><mat-icon>
                  edit_square
                </mat-icon>Edit </button>
            </div>
          </div>
          <div class="display-flex">
            <div class="card__col-xs-12">
              <div class="card__col-sm-3">
                <button type="submit" class="tbd-btn-delete" (click)="deleteImmovableAssetsArray()"><i
                    class="fa fa-trash" aria-hidden="true">&nbsp;</i>Delete</button>
              </div>
              <div class="card__col-sm-6 txt-center">
                <table>
                  <tr *ngFor="let item of immovableAssetArray.controls | paginate:config"></tr>
                </table>
                <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>
              </div>
              <div class="card__col-sm-3" style="text-align: right;">
                <button type="submit" class="tbd-btn save-btn" [disabled]="immovableAssetForm.invalid"
                  (click)="saveImmovableAssets()">Save</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </mat-expansion-panel>
</mat-accordion>

<div class="card mt-5 mb-5">
  <div class="display-flex mt-3 mb-3">
    <div class="card__col-xs-12 card__col-sm-8 isDeduction">
      B. Add Details of Movable Assets
    </div>
  </div>
  <form [formGroup]="movableAssetsForm">
    <div class="display-flex mt-2">

      <mat-checkbox color="primary" name="hasEdit" formControlName="hasEdit" class="ml30">
      </mat-checkbox>
      <div class="card__col-xs-12 card__col-sm-12">
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label class="mb-16">Jwellery, bullion, etc.</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="jwelleryAmount" formControlName="jwelleryAmount" maxlength="14"
              digitsOnly placeholder="Amount">
            <mat-error *ngIf="movableAssetsForm.controls['jwelleryAmount'].hasError('required')">
              Enter Amount.</mat-error>
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label>Archaeological collections, drawings, paintings, sculpture, any work of art</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="artWorkAmount" formControlName="artWorkAmount" maxlength="14"
              digitsOnly matTooltip="Archaeological collections, drawings, paintings, sculpture, any work of art"
              matTooltipClass="tab-tooltip" matTooltipPosition="above" placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label class="mb-16">Vehicles, yachts, boats and aircrafts</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="vehicleAmount" formControlName="vehicleAmount" maxlength="14"
              digitsOnly matTooltip="Vehicles, yachts, boats and aircrafts" matTooltipClass="tab-tooltip"
              matTooltipPosition="above" placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="financial-assets mb-3">Financial Assets</div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label>a. Bank (including all deposits)</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="bankAmount" formControlName="bankAmount" maxlength="14" digitsOnly
              placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label>b. Shares and securities</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="shareAmount" formControlName="shareAmount" maxlength="14"
              digitsOnly placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label>c. Insurance polices</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="insuranceAmount" formControlName="insuranceAmount" maxlength="14"
              digitsOnly placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label>d. Loans and advances given</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="loanAmount" formControlName="loanAmount" maxlength="14" digitsOnly
              placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-4">
          <mat-label>e. Cash in hand</mat-label>
          <mat-form-field appearance="outline" class="movable-assets">
            <input matInput class="input-field" name="cashInHand" formControlName="cashInHand" maxlength="14" digitsOnly
              placeholder="Amount">
          </mat-form-field>
        </div>
        <div class="card__col-xs-12 card__col-sm-12">
          <div class="card__col-xs-12 card__col-sm-4">
            <mat-label class="mb-16">C. Liabilities in relation to Assets at (A+B)</mat-label>
            <mat-form-field appearance="outline" class="movable-assets">
              <input matInput class="input-field" name="assetLiability" formControlName="assetLiability" maxlength="14"
                digitsOnly placeholder="Amount">
            </mat-form-field>
          </div>
        </div>
      </div>
      <div class="edit-head edit-assets">
        <button type="button" class="edit-donation" (click)="movableAssetsForm.enable()"><mat-icon>
            edit_square
          </mat-icon>Edit </button>
      </div>
    </div>
    <div class="display-flex mb-3">
      <div class="card__col-xs-12">
        <div class="" style="text-align: right;">
          <button type="submit" class="tbd-btn save-btn" [disabled]="movableAssetsForm.invalid"
            (click)="saveMovableAssets()">Save</button>
        </div>
      </div>
    </div>
  </form>
</div>


<div class="flex justify-between border-t mt-[75px] m-[25px] py-[25px]">
  <button
    class="display-flex btn normal-case h-fit min-h-fit transition-all duration-300 bg-white hover:bg-sky-700 hover:border-sky-700 py-3 px-7 hover:text-white">
    <mat-icon>keyboard_backspace</mat-icon>
    <span class="font-semibold" (click)="goBack()">&nbsp;Back to More Info List</span>
  </button>

  <button
    class="btn normal-case h-fit min-h-fit transition-all duration-300 bg-sky-600 hover:bg-sky-700 hover:border-sky-700 py-3 px-7 text-white">
    <span class="font-semibold" (click)="saveAll()">Save All</span>
  </button>
</div>