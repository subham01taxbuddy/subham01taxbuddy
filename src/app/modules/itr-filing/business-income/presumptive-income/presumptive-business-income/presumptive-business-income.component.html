<div style="overflow: hidden">
  <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '14px', fullScreenBackdrop: true }"></ngx-loading>
  <div class="page-wrapper">
    <!-- main area -->
    <main>
      <div class="frameC">
        <div class="div">
          <div class="text-wrapper">Presumptive Income</div>
          <div class="mingcute-down-fill"></div>
        </div>
        <div class="space">
          <div class="div-2">
            <div class="div-4">
              <div class="frame-wrapper-2A">
                <div class="accordion" id="myAccordion">
                  <div class="accordion-item">
                    <h2 class="accordion-header accoHdclr" id="headingOne">
                      <button type="button" class="accordion-button" data-bs-toggle="collapse"
                        data-bs-target="#collapseOne">Business Income</button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#myAccordion">
                      <div class="card-body">
                        <form [formGroup]="busIncomeForm">

                          <!-- hdRow -->
                          <div class="pre-box1">

                            <div class="hdByr-L">
                              Business Income 44AD
                            </div>

                            <div class="hdByr-R">

                              <div class="Bx4">
                                <div class="Bx4L">
                                  <button type="submit" (click)="deleteArray()" [disabled]="!busSelected()">
                                    <i class="fa fa-trash-o delbt" aria-hidden="true"></i>
                                  </button>
                                </div>
                                <div class="Bx4R">
                                  <button type="button" class="addAno" (click)="addBusIncomeForm()"> + Add Another
                                  </button>
                                </div>
                              </div>

                            </div>


                          </div>
                          <!-- row1 -->
                          <div class="land-box-buyr" formArrayName="busIncomeFormArray">
                            <div class="PreBoxOut" *ngFor="
                                let income of busIncomeFormArray.controls | paginate : config;
                                let i = index
                              " [formGroupName]="fieldGlobalIndex(i)">

                              <div class="PreBxUp">
                                <div class="col-sm-1">
                                  <mat-checkbox name="hasEdit[i]" formControlName="hasEdit" class="tpBtn1">
                                  </mat-checkbox>
                                </div>
                                <div class="field">
                                  <app-business-input-autocomplete [businessType]="'44AD'" [selectedInput]="
                                  busIncomeFormArray.controls[i].get('natureOfBusiness')
                                    .value
                                " (businessSelected)="businessClicked($event, i)">
                                  </app-business-input-autocomplete>

                                  <mat-error *ngIf="
                                  (busIncomeFormArray.controls[i].get('natureOfBusiness')
                                    .touched ||
                                    submitted) &&
                                  busIncomeFormArray.controls[i]
                                    .get('natureOfBusiness')
                                    .hasError('required')
                                ">Please select</mat-error>
                                </div>

                                <div class="field">
                                  <div class="field-label">
                                    <span class="span">Trade Name</span> <span class="text-wrapper-2">*</span>
                                  </div>
                                  <mat-form-field appearance="outline">
                                    <input formControlName="tradeName" matInput name="tradeName[i]" class="input-field"
                                      required />
                                  </mat-form-field>
                                  <mat-error *ngIf="(busIncomeFormArray.controls[i].get('tradeName').touched ||
                                        submitted) && busIncomeFormArray.controls[i].get('tradeName').hasError('required')
                                    ">Please enter the trade name</mat-error>
                                </div>

                                <div class="field">
                                  <div class="field-label">
                                    <span class="span">Business description</span>
                                  </div>
                                  <mat-form-field appearance="outline">
                                    <input matInput class="input-field" formControlName="description"
                                      name="description[i]" />
                                  </mat-form-field>
                                </div>
                              </div>
                              <div class="PreBxDwn">
                                <div class="pre-box">
                                  <div class="lndBldg-L">Bank Receipts <span class="redAst">*</span></div>
                                  <div class="lndBldg-R">
                                    <mat-form-field appearance="outline">
                                      <input formControlName="bankReceipts" matInput name="bankReceipts[i]"
                                        class="input-field" required digitsOnly placeholder="₹ Enter Amount" (change)=" 
                                          calculatePresumptive(fieldGlobalIndex(i), 'bank', true)
                                        " />
                                    </mat-form-field>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('bankReceipts')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('bankReceipts')
                                          .hasError('required')
                                      ">Please enter the amount</mat-error>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('bankReceipts')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('bankReceipts')
                                          .hasError('max')
                                      ">Turnover cannot be more than 2 crore</mat-error>
                                  </div>
                                </div>
                                <div class="pre-box">
                                  <div class="lndBldg-L">Minimum Presumtive Income @ 6% <span class="redAst">*</span>
                                  </div>
                                  <div class="lndBldg-R">
                                    <mat-form-field appearance="outline">
                                      <input formControlName="bankMinIncome" matInput name="bankMinIncome[i]"
                                        class="input-field" required digitsOnly readonly />
                                    </mat-form-field>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('bankMinIncome')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('bankMinIncome')
                                          .hasError('required')
                                      ">Please enter the amount</mat-error>
                                  </div>
                                </div>
                                <div class="pre-box">
                                  <div class="lndBldg-L">Presumtive income ({{
                                    bankPercentage[i] ? bankPercentage[i] : 0
                                    }}%) </div>
                                  <div class="lndBldg-R">
                                    <mat-form-field appearance="outline">
                                      <input formControlName="bankPreIncome" placeholder="₹ Enter Amount" matInput
                                        name="bankPreIncome[i]" class="input-field" required digitsOnly (change)="
                                          calculatePresumptive(fieldGlobalIndex(i), 'bank', true)
                                        " />
                                    </mat-form-field>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('bankPreIncome')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('bankPreIncome')
                                          .hasError('min')
                                      ">Amount should be greater than {{ amountSix }}
                                    </mat-error>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('bankPreIncome')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('bankPreIncome')
                                          .hasError('max')
                                      ">Amount cannot be greater than {{ maxSixAmt }}
                                    </mat-error>
                                  </div>
                                </div>
                              </div>

                              <div class="PreBxDwn">
                                <div class="pre-box">
                                  <div class="lndBldg-L">Cash Receipts <span class="redAst">*</span></div>
                                  <div class="lndBldg-R">
                                    <mat-form-field appearance="outline">
                                      <input formControlName="cashReceipts" placeholder="₹ Enter Amount" matInput
                                        name="cashReceipts[i]" class="input-field" required digitsOnly (change)="
                                            calculatePresumptive(fieldGlobalIndex(i), 'cash', true)
                                          " />
                                    </mat-form-field>
                                    <mat-error *ngIf="
                                          (busIncomeFormArray.controls[i].get('cashReceipts')
                                            .touched ||
                                            submitted) &&
                                          busIncomeFormArray.controls[i]
                                            .get('cashReceipts')
                                            .hasError('required')
                                        ">Please enter the amount</mat-error>
                                    <mat-error *ngIf="
                                          (busIncomeFormArray.controls[i].get('cashReceipts')
                                            .touched ||
                                            submitted) &&
                                          busIncomeFormArray.controls[i]
                                            .get('cashReceipts')
                                            .hasError('max')
                                        ">Turnover cannot be more than 2 crore</mat-error>

                                  </div>
                                </div>
                                <div class="pre-box">
                                  <div class="lndBldg-L">Minimum Presumtive Income @ 8% <span class="redAst">*</span>
                                  </div>
                                  <div class="lndBldg-R">
                                    <mat-form-field appearance="outline">
                                      <input formControlName="cashMinIncome" matInput name="cashMinIncome[i]"
                                        class="input-field" required digitsOnly readonly />
                                    </mat-form-field>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('cashMinIncome')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('cashMinIncome')
                                          .hasError('required')
                                      ">Please enter the amount</mat-error>
                                  </div>
                                </div>
                                <div class="pre-box">
                                  <div class="lndBldg-L">Presumtive income ({{
                                    cashPercentage[i] ? cashPercentage[i] : 0
                                    }}%)</div>
                                  <div class="lndBldg-R">
                                    <mat-form-field appearance="outline">
                                      <input formControlName="cashPreIncome" placeholder="₹ Enter Amount" matInput
                                        name="cashPreIncome[i]" class="input-field" required digitsOnly (change)="
                                          calculatePresumptive(fieldGlobalIndex(i), 'cash', true)
                                        " />
                                    </mat-form-field>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('cashPreIncome')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('cashPreIncome')
                                          .hasError('min')
                                      ">Amount should be greater than {{ amountEight }}
                                    </mat-error>
                                    <mat-error *ngIf="
                                        (busIncomeFormArray.controls[i].get('cashPreIncome')
                                          .touched ||
                                          submitted) &&
                                        busIncomeFormArray.controls[i]
                                          .get('cashPreIncome')
                                          .hasError('max')
                                      ">Amount cannot be greater than {{ maxEightAmt }}
                                    </mat-error>
                                  </div>
                                </div>
                              </div>

                            </div>
                          </div>
                        </form>

                        <div class="row spsTp bdrTp" style="margin: 0px 20px">
                          <div class="col-sm-6 txt-center">
                            <table>
                              <tr *ngFor="let item of getBusIncomeArray.controls | paginate : config"></tr>
                            </table>
                            <pagination-controls id="businessConfig"
                              (pageChange)="pageChanged($event)"></pagination-controls>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
